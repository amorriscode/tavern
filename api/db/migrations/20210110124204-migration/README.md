# Migration `20210110124204-migration`

This migration has been generated by Anthony Morris at 1/10/2021, 4:42:04 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE "Transaction" ADD COLUMN     "userId" TEXT

ALTER TABLE "User" ADD COLUMN     "experience" INTEGER NOT NULL DEFAULT 0

ALTER TABLE "Transaction" ADD FOREIGN KEY("userId")REFERENCES "User"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20210110123526-migration..20210110124204-migration
--- datamodel.dml
+++ datamodel.dml
@@ -1,9 +1,9 @@
 datasource DS {
   // optionally set multiple providers
   // example: provider = ["sqlite", "postgresql"]
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider      = "prisma-client-js"
@@ -93,21 +93,23 @@
   guildId String?
   delta   Int
   result  Int // total experience after delta
   time    DateTime @default(now())
-  // todo: user id
-  // transactions can exist for both users + guilds
+  user    User?    @relation(fields: [userId], references: [id])
+  userId  String?
 }
 model User {
-  id      String  @id @default(uuid())
-  name    String
-  email   String  @unique
-  guild   Guild?  @relation(fields: [guildId], references: [id])
-  guildId String?
-  level   Int
-  title   Title   @relation(fields: [titleId], references: [id])
-  titleId String
+  id          String        @id @default(uuid())
+  name        String
+  email       String        @unique
+  guild       Guild?        @relation(fields: [guildId], references: [id])
+  guildId     String?
+  level       Int
+  title       Title         @relation(fields: [titleId], references: [id])
+  titleId     String
+  transaction Transaction[]
+  experience  Int           @default(0)
 }
 model Title {
   id          String @id @default(uuid())
```


